#![allow(clippy::missing_panics_doc)]
use std::io::BufReader;

use crate::identification::{test_format, NovoBData, NovoBVersion};

#[test]
fn novob() {
    match test_format::<NovoBData>(
        BufReader::new(NOVOB_V0_0_1.as_bytes()),
        None,
        false,
        false,
        Some(NovoBVersion::V0_0_1),
    ) {
        Ok(n) => assert_eq!(n, 20),
        Err(e) => {
            println!("{e}");
            panic!("Failed identified peptides test");
        }
    }
}

const NOVOB_V0_0_1: &str = "1	2	2412.424	['VATTAYDYYSYSVITDAIYNF']	-8.679	0.000000	['FGVGAENYGDDEEGDIEEIIINIIEK']	-449.920	0.000000
2	2	2412.424	['STSGDTISEINSEIIEEQVGVNK']	-17.753	0.000000	['mAITmASTQIEDITDEEIIEIIIEK']	-449.991	0.000000
3	4	1735.869	['HKDGSTEIKDnKTNR']	11.023	0.000013	['CDVNHKIPSNTKVDK']	0.000	0.077978
4	4	2869.220	['RPPPPPPSPPPPPEEGPTAPPRPQTYH']	-2.230	0.000000	['TREPQEPMEHQGGSGPESGQENSTYR']	-0.014	0.000000
5	4	2869.220	['KTPPPEEEGKEECEGGDAmNENPAEK']	0.014	0.000000	['DIGESVEHCEHSKPSCQPSNGNTYR']	0.003	0.000000
6	4	2894.252	['RPPGGAEEEEEEYRPEPEGEHSSGMK']	0.008	0.000000	['NAGTYKEEEEEEVQSSGDKYNSTYR']	0.002	0.000000
7	4	2894.252	['KTPSPSIKPSSSSSSSSSSSSHSHIPIIF']	-30.199	0.000000	['IVEIHGETAMQGAHGGGGGGSGPNDTSTYR']	-0.045	0.000000
8	4	2951.276	['GSGGGGGGGRGSGGGGSGSGTTKTSDPGEGSGSGSSR']	0.024	0.000000	['GTIGAVFGEHAASGEHGGGSSSGSGGYSSMSGK']	0.007	0.000000
9	4	1645.895	['HKPSSTKPVFPPSQK']	0.000	0.003877	['NVQGDKKNAIVHVDK']	0.005	0.000040
10	4	2748.191	['GSGGGGGGGGGGGGSGGGGAGIGSGGPGHRPGTSCR']	0.012	0.000000	['GGENSSEHKPEEQVTGmGQENSTYR']	0.021	0.000000
11	4	2748.191	['EGEGEGRPSEETKEMPTPSSSSMATR']	-0.007	0.000000	['CRPASEIGANAGGHAGSGSGYSETSGSSR']	0.003	0.000000
12	4	2910.248	['SSNGGGSGGGGGGGGGGASSSSSSSSSSSSSIRPPK']	-0.002	0.000000	['KIEEEGDQSGEHSHGGPGSSSGEQQGYR']	0.008	0.000000
13	3	1735.866	['HKDGSENVPSNTKVDK']	0.016	0.023430	['IANTSDHKPSNTKVDK']	-0.019	0.034890
14	3	1735.866	['mVPKTDASEHRPKDK']	-0.001	0.008308	['mVVKTNPEHESPKDK']	0.008	0.000015
15	3	2894.246	['GQCGEYGSGGGGGGGGGAGGGGGGGGGGGGGGGGIGAGGGm']	0.152	0.000000	['VHQKEGESSEAGHYPGSYGSGNESTYR']	-0.002	0.000000
16	3	2894.246	['FSAGSCGDIKEESSPCPESEEEIIQK']	-0.014	0.000000	['KSKGANDEADSSEHSGDYYQEEPTIR']	-0.013	0.000000
17	3	2951.272	['SCYTTSSSSSSSSSSSSSSSHEEIQIKR']	0.002	0.000000	['FGIAANDTDSSSSSSGSPSPISSSSSGNSHR']	-0.002	0.000000
18	3	2951.272	['SSSSSSNGSSSSSSSSSSSSSSSNVEEPIRD']	0.074	0.000000	['KDEAYNKEDDGSQTSGEDNEEINNIR']	0.005	0.000000
206	4	2388.897	['']	2388.897	0.000000	['']	2388.897	0.000000
189	3	1269.642	['HEyGIRRNyqmyIIDqqGVYIVMGTSqPtSLIPH']	-2104.704	0.000000	['']	1269.642	0.000000";
